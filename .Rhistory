output_matrix <- transformation_matrix %*% input_matrix
input_df <- as.data.frame(t(input_matrix))
colnames(input_df) <- c("x", "y", "z")
output_df <- as.data.frame(t(output_matrix))
colnames(output_df) <- c("x", "y", "z")
df <- bind_rows(list(input = input_df, output = output_df), .id = "status")
df %>%
filter(status == "output") %>%
plot_ly(x = ~x, y = ~y, z = ~z) %>%
add_mesh(
i = c(7, 0, 0, 0, 4, 4, 6, 6, 4, 0, 3, 2),
j = c(3, 4, 1, 2, 5, 6, 5, 2, 0, 1, 6, 3),
k = c(0, 7, 2, 3, 6, 7, 1, 1, 5, 5, 7, 6),
intensity = seq(0, 1, length = 8),
color = seq(0, 1, length = 8),
colors = colorRamp(rainbow(8))
)
df %>%
filter(status == "output") %>%
plot_ly(x = ~x, y = ~y, z = ~z) %>%
add_mesh(
i = c(7, 0, 0, 0, 4, 4, 6, 6, 4, 0, 3, 2),
j = c(3, 4, 1, 2, 5, 6, 5, 2, 0, 1, 6, 3),
k = c(0, 7, 2, 3, 6, 7, 1, 1, 5, 5, 7, 6),
intensity = seq(0, 1, length = 8),
color = seq(0, 1, length = 8),
colors = colorRamp(rainbow(8))
) %>%
layout(
xaxis = list(range = c(0, 2)),
yaxis = list(range = c(0, 2)),
zaxis = list(range = c(0, 2))
)
df %>%
filter(status == "output") %>%
plot_ly(x = ~x, y = ~y, z = ~z) %>%
add_mesh(
i = c(7, 0, 0, 0, 4, 4, 6, 6, 4, 0, 3, 2),
j = c(3, 4, 1, 2, 5, 6, 5, 2, 0, 1, 6, 3),
k = c(0, 7, 2, 3, 6, 7, 1, 1, 5, 5, 7, 6),
intensity = seq(0, 1, length = 8),
color = seq(0, 1, length = 8),
colors = colorRamp(rainbow(8))
) %>%
layout(
xaxis = list(range = c(0, 4)),
yaxis = list(range = c(0, 4)),
zaxis = list(range = c(0, 4))
)
axx <- list(nticks = 4, range = c(0, 2))
axy <- list(nticks = 4, range = c(0, 2))
axz <- list(nticks = 4, range = c(0, 2))
df %>%
filter(status == "output") %>%
plot_ly(x = ~x, y = ~y, z = ~z) %>%
add_mesh(
i = c(7, 0, 0, 0, 4, 4, 6, 6, 4, 0, 3, 2),
j = c(3, 4, 1, 2, 5, 6, 5, 2, 0, 1, 6, 3),
k = c(0, 7, 2, 3, 6, 7, 1, 1, 5, 5, 7, 6),
intensity = seq(0, 1, length = 8),
color = seq(0, 1, length = 8),
colors = colorRamp(rainbow(8))
) %>%
layout(scene = list(xaxis = axx, yaxis = axy, zaxis = axz))
axx <- list(nticks = 4, range = c(0, 4))
axy <- list(nticks = 4, range = c(0, 4))
axz <- list(nticks = 4, range = c(0, 4))
df %>%
filter(status == "output") %>%
plot_ly(x = ~x, y = ~y, z = ~z) %>%
add_mesh(
i = c(7, 0, 0, 0, 4, 4, 6, 6, 4, 0, 3, 2),
j = c(3, 4, 1, 2, 5, 6, 5, 2, 0, 1, 6, 3),
k = c(0, 7, 2, 3, 6, 7, 1, 1, 5, 5, 7, 6),
intensity = seq(0, 1, length = 8),
color = seq(0, 1, length = 8),
colors = colorRamp(rainbow(8))
) %>%
layout(scene = list(xaxis = axx, yaxis = axy, zaxis = axz))
axx <- list(nticks = 6, range = c(0, 4))
axy <- list(nticks = 6, range = c(0, 4))
axz <- list(nticks = 6, range = c(0, 4))
df %>%
filter(status == "output") %>%
plot_ly(x = ~x, y = ~y, z = ~z) %>%
add_mesh(
i = c(7, 0, 0, 0, 4, 4, 6, 6, 4, 0, 3, 2),
j = c(3, 4, 1, 2, 5, 6, 5, 2, 0, 1, 6, 3),
k = c(0, 7, 2, 3, 6, 7, 1, 1, 5, 5, 7, 6),
intensity = seq(0, 1, length = 8),
color = seq(0, 1, length = 8),
colors = colorRamp(rainbow(8))
) %>%
layout(scene = list(xaxis = axx, yaxis = axy, zaxis = axz))
######
#####2D#######
input_matrix <- matrix(
c(c(0, 1, 1, 0), c(0, 0, 1, 1)),
nrow = 2,
ncol = 4,
byrow = TRUE
)
input_matrix
input_matrix <- matrix(
c(c(0, 1, 1, 0), c(0, 0, 1, 1)),
nrow = 2,
ncol = 4,
byrow = TRUE
)
transformation_matrix <- matrix(c(2, 0, 0, 2), 2, 2, byrow = TRUE)
output_matrix <- transformation_matrix %*% input_matrix
output_matrix
input_df <- as.data.frame(t(input_matrix))
colnames(input_df) <- c("x", "y")
output_df <- as.data.frame(t(output_matrix))
colnames(output_df) <- c("x", "y")
output_matrix
output_df
df <- bind_rows(list(input = input_df, output = output_df), .id = "status")
input_matrix <- matrix(
c(c(0, 1, 1, 0), c(0, 0, 1, 1)),
nrow = 2,
ncol = 4,
byrow = TRUE
)
transformation_matrix <- matrix(c(2, 0, 0, 2), 2, 2, byrow = TRUE)
output_matrix <- transformation_matrix %*% input_matrix
input_df <- as.data.frame(t(input_matrix))
colnames(input_df) <- c("x", "y")
output_df <- as.data.frame(t(output_matrix))
colnames(output_df) <- c("x", "y")
df <- bind_rows(list(input = input_df, output = output_df), .id = "status")
p <- df %>%
filter(status == "output") %>%
plot_ly(x = ~x, y = ~y) %>%
add_trace(
type = 'scatter',
fill = 'toself',
fillcolor = '#ab63fa',
hoveron = 'points+fills',
marker = list(
color = '#ab63fa'
),
line = list(
color = '#ab63fa'
),
text = "Points + Fills",
hoverinfo = 'text'
)
p
p <- df %>%
filter(status == "input") %>%
plot_ly(x = ~x, y = ~y) %>%
add_trace(
type = 'scatter',
fill = 'toself',
fillcolor = '#ab63fa',
hoveron = 'points+fills',
marker = list(
color = '#ab63fa'
),
line = list(
color = '#ab63fa'
),
text = "Points + Fills",
hoverinfo = 'text'
)
p
# Load packages
library(plotly)
library(purrr)
library(dplyr)
library(stringr)
library(shiny)
library(shinythemes)
library(shinyMatrix)
library(xtable)
# Source script
setwd(dir = dirname(rstudioapi::getSourceEditorContext()$path))
source("utils.R")
# Create user interface
ui <- fluidPage(
theme = shinytheme("cerulean"),
titlePanel(
headerPanel("Linear Transformations")
),
withMathJax(),
sidebarLayout(
sidebarPanel(
radioButtons(
"dimension",
label = "Choose number of dimensions",
choices = c("2D", "3D"),
selected = "2D"
),
matrixInput(
"transform_mat",
label = "Input the transformation matrix",
value = matrix(c(1, 0, 0, 1), nrow = 2, ncol = 2, byrow = FALSE),
rows = list(names = FALSE),
cols = list(names = FALSE),
class = "numeric",
copy = TRUE,
paste = TRUE
)
),
mainPanel(
tabsetPanel(
type = "tabs",
tabPanel("Plot",  plotlyOutput("plot")),
tabPanel("Null Space", uiOutput("null_space")),
tabPanel("Determinant", uiOutput("determinant")),
tabPanel("Inverse Matrix", uiOutput("inverse_matrix"))
)
)
)
)
# Define server function
server <- function(input, output, session) {
observeEvent(input$dimension, {
mat_options <- list(
"2D" = matrix(c(1, 0, 0, 1), nrow = 2, ncol = 2, byrow = FALSE),
"3D" = matrix(c(1, 0, 0, 0, 1, 0, 0, 0, 1), nrow = 3, ncol = 3, byrow = FALSE)
)
updateMatrixInput(
session,
"transform_mat",
value = mat_options[[input$dimension]]
)
})
output$plot <- renderPlotly({
if (input$dimension == "2D") {
plots <- plot_2d(input$transform_mat)
} else {
plots <- plot_3d(input$transform_mat)
}
plots
})
output$determinant <- renderUI({
withMathJax(
helpText(write_determinant(input$transform_mat, dimension = input$dimension))
)
})
}
# Run shiny application
shinyApp(ui, server)
source("test.R")
# Create user interface
ui <- fluidPage(
theme = shinytheme("cerulean"),
titlePanel(
headerPanel("Linear Transformations")
),
withMathJax(),
sidebarLayout(
sidebarPanel(
radioButtons(
"dimension",
label = "Choose number of dimensions",
choices = c("2D", "3D"),
selected = "2D"
),
matrixInput(
"transform_mat",
label = "Input the transformation matrix",
value = matrix(c(1, 0, 0, 1), nrow = 2, ncol = 2, byrow = FALSE),
rows = list(names = FALSE),
cols = list(names = FALSE),
class = "numeric",
copy = TRUE,
paste = TRUE
)
),
mainPanel(
tabsetPanel(
type = "tabs",
tabPanel("Plot",  plotlyOutput("plot")),
tabPanel("Null Space", uiOutput("null_space")),
tabPanel("Determinant", uiOutput("determinant")),
tabPanel("Inverse Matrix", uiOutput("inverse_matrix"))
)
)
)
)
# Define server function
server <- function(input, output, session) {
observeEvent(input$dimension, {
mat_options <- list(
"2D" = matrix(c(1, 0, 0, 1), nrow = 2, ncol = 2, byrow = FALSE),
"3D" = matrix(c(1, 0, 0, 0, 1, 0, 0, 0, 1), nrow = 3, ncol = 3, byrow = FALSE)
)
updateMatrixInput(
session,
"transform_mat",
value = mat_options[[input$dimension]]
)
})
output$plot <- renderPlotly({
if (input$dimension == "2D") {
plots <- plot_2d(input$transform_mat)
} else {
plots <- plot_3d(input$transform_mat)
}
plots
})
output$determinant <- renderUI({
withMathJax(
helpText(write_determinant(input$transform_mat, dimension = input$dimension))
)
})
}
# Run shiny application
shinyApp(ui, server)
plot_3d <- function(transformation_matrix) {
# Input matrix: each column vector is a point in space of a cube
input_matrix <- matrix(
c(c(0, 0, 1, 1, 0, 0, 1, 1), c(0, 1, 1, 0, 0, 1, 1, 0), c(0, 0, 0, 0, 1, 1, 1, 1)),
nrow = 3,
ncol = 8,
byrow = TRUE
)
output_matrix <- transformation_matrix %*% input_matrix
input_df <- as.data.frame(t(input_matrix))
colnames(input_df) <- c("x", "y", "z")
output_df <- as.data.frame(t(output_matrix))
colnames(output_df) <- c("x", "y", "z")
df <- bind_rows(list(input = input_df, output = output_df), .id = "status")
min_coordinate <- min(min(input_matrix), min(output_matrix))
max_coordinate <- max(max(input_matrix), max(output_matrix))
if (abs(min_coordinate) > abs(max_coordinate)) {
max_coordinate <- abs(min_coordinate)
} else {
min_coordinate <- -1 * max_coordinate
}
axis_lim <- list(nticks = 6, range = c(min_coordinate, max_coordinate))
plot_list <- purrr::map2(c("input", "output"), c("scene1", "scene2"), function(type, scene) {
if (type == "output" & qr(transformation_matrix)$rank == 1) {
index <- which(colSums(transformation_matrix != 0) != 0)[1]
line_vector <- transformation_matrix[, index]
scalars <- seq(0, 1, by = 0.01)
points <- map(scalars, ~ .x * line_vector)
points <- t(as.data.frame(points))
rownames(points) <- NULL
colnames(points) <- c("x", "y", "z")
points <- as.data.frame(points)
p_output <- points %>%
plot_ly(x = ~x, y = ~y, z = ~z, scene = scene) %>%
add_lines()
return(p_output)
} else {
p <- df %>%
filter(status == type) %>%
plot_ly(x = ~x, y = ~y, z = ~z, scene = scene) %>%
add_mesh(
i = c(7, 0, 0, 0, 4, 4, 6, 6, 4, 0, 3, 2),
j = c(3, 4, 1, 2, 5, 6, 5, 2, 0, 1, 6, 3),
k = c(0, 7, 2, 3, 6, 7, 1, 1, 5, 5, 7, 6),
intensity = seq(0, 1, length = 8),
color = I("gray"),
# colors = colorRamp(rainbow(8)),
showscale = FALSE
)
if (type == "input") {
p %>%
layout(scene = list(xaxis = axis_lim, yaxis = axis_lim, zaxis = axis_lim))
} else {
p %>%
layout(scene2 = list(xaxis = axis_lim, yaxis = axis_lim, zaxis = axis_lim))
}
}
})
names(plot_list) <- c("input", "output")
subplot(plot_list$input, plot_list$output, margin = 0.5) %>%
layout(
scene = list(domain = list(x = 0)),
scene2 = list(domain = list(x = 0.5)),
showlegend = FALSE
)
}
# Create user interface
ui <- fluidPage(
theme = shinytheme("cerulean"),
titlePanel(
headerPanel("Linear Transformations")
),
withMathJax(),
sidebarLayout(
sidebarPanel(
radioButtons(
"dimension",
label = "Choose number of dimensions",
choices = c("2D", "3D"),
selected = "2D"
),
matrixInput(
"transform_mat",
label = "Input the transformation matrix",
value = matrix(c(1, 0, 0, 1), nrow = 2, ncol = 2, byrow = FALSE),
rows = list(names = FALSE),
cols = list(names = FALSE),
class = "numeric",
copy = TRUE,
paste = TRUE
)
),
mainPanel(
tabsetPanel(
type = "tabs",
tabPanel("Plot",  plotlyOutput("plot")),
tabPanel("Null Space", uiOutput("null_space")),
tabPanel("Determinant", uiOutput("determinant")),
tabPanel("Inverse Matrix", uiOutput("inverse_matrix"))
)
)
)
)
# Define server function
server <- function(input, output, session) {
observeEvent(input$dimension, {
mat_options <- list(
"2D" = matrix(c(1, 0, 0, 1), nrow = 2, ncol = 2, byrow = FALSE),
"3D" = matrix(c(1, 0, 0, 0, 1, 0, 0, 0, 1), nrow = 3, ncol = 3, byrow = FALSE)
)
updateMatrixInput(
session,
"transform_mat",
value = mat_options[[input$dimension]]
)
})
output$plot <- renderPlotly({
if (input$dimension == "2D") {
plots <- plot_2d(input$transform_mat)
} else {
plots <- plot_3d(input$transform_mat)
}
plots
})
output$determinant <- renderUI({
withMathJax(
helpText(write_determinant(input$transform_mat, dimension = input$dimension))
)
})
}
# Run shiny application
shinyApp(ui, server)
source("test.R")
# Create user interface
ui <- fluidPage(
theme = shinytheme("cerulean"),
titlePanel(
headerPanel("Linear Transformations")
),
withMathJax(),
sidebarLayout(
sidebarPanel(
radioButtons(
"dimension",
label = "Choose number of dimensions",
choices = c("2D", "3D"),
selected = "2D"
),
matrixInput(
"transform_mat",
label = "Input the transformation matrix",
value = matrix(c(1, 0, 0, 1), nrow = 2, ncol = 2, byrow = FALSE),
rows = list(names = FALSE),
cols = list(names = FALSE),
class = "numeric",
copy = TRUE,
paste = TRUE
)
),
mainPanel(
tabsetPanel(
type = "tabs",
tabPanel("Plot",  plotlyOutput("plot")),
tabPanel("Null Space", uiOutput("null_space")),
tabPanel("Determinant", uiOutput("determinant")),
tabPanel("Inverse Matrix", uiOutput("inverse_matrix"))
)
)
)
)
# Define server function
server <- function(input, output, session) {
observeEvent(input$dimension, {
mat_options <- list(
"2D" = matrix(c(1, 0, 0, 1), nrow = 2, ncol = 2, byrow = FALSE),
"3D" = matrix(c(1, 0, 0, 0, 1, 0, 0, 0, 1), nrow = 3, ncol = 3, byrow = FALSE)
)
updateMatrixInput(
session,
"transform_mat",
value = mat_options[[input$dimension]]
)
})
output$plot <- renderPlotly({
if (input$dimension == "2D") {
plots <- plot_2d(input$transform_mat)
} else {
plots <- plot_3d(input$transform_mat)
}
plots
})
output$determinant <- renderUI({
withMathJax(
helpText(write_determinant(input$transform_mat, dimension = input$dimension))
)
})
}
# Run shiny application
shinyApp(ui, server)
